{
  "version": 3,
  "sources": ["../../../Modules/Common/Helpers/ExcelExportHelper.ts"],
  "sourcesContent": ["import { DataGrid, ToolButton } from \"@serenity-is/corelib\";\r\nimport { coalesce, deepClone, ListRequest, postToService } from \"@serenity-is/corelib/q\";\r\n\r\nexport interface ExcelExportOptions {\r\n    grid: DataGrid<any, any>;\r\n    service: string;\r\n    onViewSubmit: () => boolean;\r\n    editRequest?: (request: ListRequest) => ListRequest;\r\n    title?: string;\r\n    hint?: string;\r\n    separator?: boolean;\r\n}\r\n\r\nexport namespace ExcelExportHelper {\r\n\r\n    export function createToolButton(options: ExcelExportOptions): ToolButton {\r\n\r\n        return {\r\n            hint: coalesce(options.hint, 'Excel'),\r\n            title: coalesce(options.title, ''),\r\n            cssClass: 'export-xlsx-button',\r\n            icon: 'fa-file-excel-o',\r\n            onClick: function () {\r\n                if (!options.onViewSubmit()) {\r\n                    return;\r\n                }\r\n\r\n                let grid = options.grid;\r\n\r\n                var request = deepClone(grid.getView().params) as ListRequest;\r\n                request.Take = 0;\r\n                request.Skip = 0;\r\n                var sortBy = grid.getView().sortBy;\r\n                if (sortBy) {\r\n                    request.Sort = sortBy;\r\n                }\r\n\r\n                request.ExportColumns = [];\r\n                let columns = grid.getGrid().getColumns();\r\n                for (let column of columns) {\r\n                    request.ExportColumns.push(column.id || column.field);\r\n                }\r\n\r\n                if (options.editRequest)\r\n                    request = options.editRequest(request);\r\n\r\n                postToService({ service: options.service, request: request, target: '_blank' });\r\n            },\r\n            separator: options.separator\r\n        };\r\n    }\r\n}\r\n"],
  "mappings": "iDACA,IAAAA,EAAgE,SAYzD,IAAUC,MAAV,CAEI,SAASC,EAAiBC,EAAyC,CAEtE,MAAO,CACH,QAAM,YAASA,EAAQ,KAAM,OAAO,EACpC,SAAO,YAASA,EAAQ,MAAO,EAAE,EACjC,SAAU,qBACV,KAAM,kBACN,QAAS,UAAY,CACjB,GAAI,CAACA,EAAQ,aAAa,EACtB,OAGJ,IAAIC,EAAOD,EAAQ,KAEnB,IAAIE,KAAU,aAAUD,EAAK,QAAQ,EAAE,MAAM,EAC7CC,EAAQ,KAAO,EACfA,EAAQ,KAAO,EACf,IAAIC,EAASF,EAAK,QAAQ,EAAE,OACxBE,IACAD,EAAQ,KAAOC,GAGnBD,EAAQ,cAAgB,CAAC,EACzB,IAAIE,EAAUH,EAAK,QAAQ,EAAE,WAAW,EACxC,QAASI,KAAUD,EACfF,EAAQ,cAAc,KAAKG,EAAO,IAAMA,EAAO,KAAK,EAGpDL,EAAQ,cACRE,EAAUF,EAAQ,YAAYE,CAAO,MAEzC,iBAAc,CAAE,QAASF,EAAQ,QAAS,QAASE,EAAS,OAAQ,QAAS,CAAC,CAClF,EACA,UAAWF,EAAQ,SACvB,CACJ,CAnCOF,EAAS,iBAAAC,EAAAO,EAAAP,EAAA,sBAFHD,MAAA",
  "names": ["import_q", "ExcelExportHelper", "createToolButton", "options", "grid", "request", "sortBy", "columns", "column", "__name"]
}
